<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- 上述3个meta标签*必须*放在最前面，任何其他内容都*必须*跟随其后！ -->
    <meta name="description" content="">
    <meta name="author" content="">
    <title>燃烧室高度检测机</title>
    <link href="css/reset.css" rel="stylesheet">
    <link href="css/main.css" rel="stylesheet">
    <script src="js/status.js"></script>
    <script src="js/jquery-3.2.1.min.js"></script>
</head>
<body>
    <div class="body_warp">
        <!--顶部标题-->
        <div class="rmheader">
            <div class="rmlogo"></div>
            <div class="rmtitle large_title">
                <strong>燃烧室高度检测机</strong>
                <div class="rmsubtitlebg"></div>
                <div class="rmsubtitle"><b></b><span>Combustion Chamber Hight Detector</span><em></em></div>
            </div>
            <div class="rmdatetime">
                <span><!--<a href=""><img src="images/icon_pr.png" alt=""></a><a href=""><img src="images/icon_back.png" alt=""></a><a href=""><img src="images/icon_close.png" alt=""></a>--></span>
                <span id='Timers'>&nbsp;</span>
            </div>
        </div>
        <div class="rmcont_column">
            <div class="cont_h468 cont_row">
                <div class="cont_w370 cont_box">
                    <div class="cont_box_leftop"></div>
                    <div class="cont_box_righttop"></div>
                    <div class="cont_box_leftbom"></div>
                    <div class="cont_box_rightbom"></div>
                    <div class="rmcont_cont_box gdj_bpx">
                        <div class="rmcont_title">
                            测距 1
                            <div>Ranging 1</div>
                        </div>
                        <div class="rmcont_cbox" id="main2"></div>
                    </div>
                </div>
                <div class="cont_w370 cont_box">
                    <div class="cont_box_leftop"></div>
                    <div class="cont_box_righttop"></div>
                    <div class="cont_box_leftbom"></div>
                    <div class="cont_box_rightbom"></div>
                    <div class="rmcont_cont_box gdj_bpx">
                        <div class="rmcont_title">
                            测距 2
                            <div>Ranging 2</div>
                        </div>
                        <div class="rmcont_cbox" id="main3"></div>
                    </div>
                </div>
                <div class="cont_w380">
                    <div class="cont_box cont_h228">
                        <div class="rmcont_cont_box">
                            <div class="rmcont_cbox">
                                <div class="detector_box">
                                    <div class="detector_box_title">当前测试产品</div>
                                    <div class="detector_box_btn" id="ProductName">发动机缸体</div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="cont_box cont_h228 margin_top_10">
                        <!--<div class="cont_box_leftop"></div>
                        <div class="cont_box_righttop"></div>
                        <div class="cont_box_leftbom"></div>
                        <div class="cont_box_rightbom"></div>-->
                        <div class="rmcont_cont_box">
                            <div class="rmcont_cbox">
                                <div class="detector_box">
                                    <div class="detector_box_title">检测结果</div>
                                    <div class="detector_box_btn" id="TestResult">OK</div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="cont_w370 cont_box">
                    <div class="cont_box_leftop"></div>
                    <div class="cont_box_righttop"></div>
                    <div class="cont_box_leftbom"></div>
                    <div class="cont_box_rightbom"></div>
                    <div class="rmcont_cont_box gdj_bpx">
                        <div class="rmcont_title">
                            测距 3
                            <div>Ranging 3</div>
                        </div>
                        <div class="rmcont_cbox" id="main4"></div>
                    </div>
                </div>
                <div class="cont_w370 cont_box">
                    <div class="cont_box_leftop"></div>
                    <div class="cont_box_righttop"></div>
                    <div class="cont_box_leftbom"></div>
                    <div class="cont_box_rightbom"></div>
                    <div class="rmcont_cont_box gdj_bpx">
                        <div class="rmcont_title">
                            测距 4
                            <div>Ranging 4</div>
                        </div>
                        <div class="rmcont_cbox" id="main5"></div>
                    </div>
                </div>
            </div>
            <div class="cont_h468 margin_top_10 cont_row">
                <div class="cont_w470 cont_box">
                    <div class="cont_box_leftop"></div>
                    <div class="cont_box_righttop"></div>
                    <div class="cont_box_leftbom"></div>
                    <div class="cont_box_rightbom"></div>
                    <div class="rmcont_cont_box">
                        <div class="rmcont_title">
                           公差
                            <div>Tolerance</div>
                        </div>
                        <div class="rmcont_cbox" id="main1"></div>
                    </div>
                </div>
                <div class="cont_w390 cont_box">
                    <div class="cont_box_leftop"></div>
                    <div class="cont_box_righttop"></div>
                    <div class="cont_box_leftbom"></div>
                    <div class="cont_box_rightbom"></div>
                    <div class="rmcont_cont_box">
                        <!--<div class="rmcont_title">
                            循环时间
                            <div>Cycle time</div>
                        </div>
                        <div class="rmcont_cbox">
                            <div class="sol_tem_time margin_top_12">
                                <div class="sol_inner_title">循环时间</div>
                                <div class="sol_inner_data1">0</div>
                                <div class="sol_inner_data2">60</div>
                            </div>
                            <div class="sol_tem_time_title margin_top_10"><span id="CycleTime">60</span><em>s</em></div>
                        </div>-->

                        <div class="rmcont_title">
                            合格数
                            <div>Qualified Quantity</div>
                        </div>
                        <div class="rmcont_cbox">
                            <div class="amount_box">
                                <strong>合格产量</strong>
                                <span id="QualifiedCount">100<em>个</em></span>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="cont_w390 cont_box">
                    <div class="cont_box_leftop"></div>
                    <div class="cont_box_righttop"></div>
                    <div class="cont_box_leftbom"></div>
                    <div class="cont_box_rightbom"></div>
                    <div class="rmcont_cont_box">
                        <div class="rmcont_title">
                            不合格数
                            <div>Unqualified Quantity</div>
                        </div>
                        <div class="rmcont_cbox">
                            <div class="amount_box">
                                <strong>不合格产量</strong>
                                <span id="UnqualifiedCount">100<em>个</em></span>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="cont_w626 cont_box">
                    <div class="cont_box_leftop"></div>
                    <div class="cont_box_righttop"></div>
                    <div class="cont_box_leftbom"></div>
                    <div class="cont_box_rightbom"></div>
                    <div class="rmcont_cont_box">
                        <div class="rmcont_title">
                            设备状态
                            <div>Device Status</div>
                        </div>
                        <div class="rmcont_cbox">
                            <div class="ments_tatus_box">
                                <ul>
                                    <li>
                                        <p>通电</p><span id="status1" class="ments_0_0"></span>
                                    </li>
                                    <li>
                                        <p>运行</p><span id="status2" class="ments_1_0"></span>
                                    </li>
                                    <li>
                                        <p>暂停</p><span id="status3" class="ments_2_0"></span>
                                    </li>
                                    <li>
                                        <p>故障</p><span id="status4" class="ments_3_0"></span>
                                    </li>
                                    <li>
                                        <p>报警</p><span id="status5" class="ments_4_0"></span>
                                    </li>
                                    <!--ments_0_0表示关闭，ments_0_1表示开启-->
                                </ul>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <script src="js/echarts/time.js"></script>
    <script src="js/echarts/echarts.js"></script>
    <script type="text/javascript" src="js/echarts/gauge.js"></script>
    <script type="text/javascript">
        function getScreenSize() {
            var valueSize = 25;//数值字体大小
            var scaleSize = 15;//刻度字体大小
            var barWidth = 10;//仪表盘宽度
            var titleSize = 20;//标题字体大小
            var height = window.screen.height;
            if (height >= 300 && height < 600) {
                valueSize = 10;//数值字体大小
                scaleSize = 0.1;//刻度字体大小
                barWidth = 6;//仪表盘宽度
                titleSize = 3;//标题字体大小
            } else if (height >= 600) {
                valueSize = 25;//数值字体大小
                scaleSize = 15;//刻度字体大小
                barWidth = 10;//仪表盘宽度
                titleSize = 20;//标题字体大小
            }
            return [valueSize, scaleSize, barWidth, titleSize];
        }
        if (!window.require) {
            require = function (a, b) {
                b(echarts);
            };
            require.config = function () { };
        }

        require.config({
            paths: {
                echarts: 'js/echarts'
            }
        });
        require(
            [
                'echarts',
                'echarts/chart/line', // 按需加载所需图表，如需动态类型切换功能，别忘了同时加载相应图表
                'echarts/chart/bar'
            ],
            function (ec) {
                //---------------------用公差设置
                var myChart = ec.init(document.getElementById('main1'));
                var option = t2(); //调用函数生成仪表
                option.series[0].title.color = '#39c87a';
                option.series[0].min = 0;
                option.series[0].max = 1;
                option.series[0].detail.formatter = "{value}MM";
                option.series[0].data[0].value = 10;
                option.series[0].data[0].name = "公差"; //
                //option.series[0].axisLabel.fontSize = 16;
                //option.series[0].title.fontSize = 26;

                option.series[0].detail.textStyle.fontSize = getScreenSize()[0];//数值字体大小
                option.series[0].axisLabel.fontSize = getScreenSize()[1];//刻度字体大小
                option.series[0].axisLine.lineStyle.width = getScreenSize()[2];//仪表盘宽度
                option.series[0].title.fontSize = getScreenSize()[3];//标题字体大小

                option.tooltip.formatter = "{a} <br/> {c}MM"; //设置弹出提示框的输出格式
                option.series[0].name = "公差"; //设置弹出提示框的名称
                option.series[0].axisLine.lineStyle.shadowColor = "#6ACA8B";
                option.series[0].axisLine.lineStyle.color = [
                    [0.2, '#b6a2de'],
                    [0.8, '#69c98b'],
                    [1, '#ffb980']
                ]; //刻度线的颜色设置
                myChart.setOption(option);

                var myChart2 = ec.init(document.getElementById('main2'));
                var option2 = {
                    grid: {
                        borderWidth: '0',
                        x: '64',
                        y: '35',
                    },
                    xAxis: [{
                        type: 'category',
                        boundaryGap: false,
                        data: ['0', '1', '2'],
                        show: false,
                        axisLine: { lineStyle: { color: "#1d3f62", width: 3 } },
                    }],
                    yAxis: [

                        {
                            name: 'mm',
                            nameTextStyle: {
                                color: '#2579cf',
                                fontSize: 18,
                                align: 'left'
                            },
                            type: 'value',
                            splitLine: {
                                lineStyle: { color: "#1d3f62", type: 'dashed' }
                            },
                            max: 10,
                            splitNumber:5,
                            axisLine: { lineStyle: { color: "#1d3f62", width: 3 } },
                            axisLabel: {
                                formatter: '{value}.00',
                                textStyle: {
                                    color: '#aaa',
                                    fontSize: 16
                                }
                            }
                        },
                        {
                            type: 'value',
                            axisLine: { lineStyle: { color: "#1d3f62", width: 3 } },
                        }
                    ],
                    series: [{
                        name: '高度值',
                        type: 'line',
                        symbolSize: 0,
                        data: [7.405, 7.405, 7.405],
                        lineStyle: { normal: { color: "#f19544", width: 4 } },
                        markPoint: {
                            symbolOffset: [0, '-55%'],
                            label: {
                                normal: { fontSize: 20, color: "#000", formatter: '{c}' },
                            },
                            symbol: 'rect',
                            itemStyle: { normal: { color: "#f4a600" } },
                            symbolSize: [120, 50],
                            position: "inside",
                            data: [
                                { name: '最低值', value: 11.405, xAxis: 1, yAxis: 11.405 }
                            ]
                        }
                    }]
                };

                myChart2.setOption(option2);

                var myChart3 = ec.init(document.getElementById('main3'));
                var option3 = {
                    grid: {
                        borderWidth: '0',
                        x: '64',
                        y: '35',
                    },
                    xAxis: [{
                        type: 'category',
                        boundaryGap: false,
                        data: ['0', '1', '2'],
                        show: false,
                        axisLine: { lineStyle: { color: "#1d3f62", width: 3 } },
                    }],
                    yAxis: [

                        {
                            name: 'mm',
                            nameTextStyle: {
                                color: '#2579cf',
                                fontSize: 18,
                                align: 'left'
                            },
                            type: 'value',
                            splitLine: {
                                lineStyle: { color: "#1d3f62", type: 'dashed' }
                            },
                            max: 10,
                            splitNumber: 5,
                            axisLine: { lineStyle: { color: "#1d3f62", width: 3 } },
                            axisLabel: {
                                formatter: '{value}.00',
                                textStyle: {
                                    color: '#aaa',
                                    fontSize: 16
                                }
                            }
                        },
                        {
                            type: 'value',
                            axisLine: { lineStyle: { color: "#1d3f62", width: 3 } },
                        }
                    ],
                    series: [{
                        name: '高度值',
                        type: 'line',
                        symbolSize: 0,
                        data: [7.408, 7.408, 7.408],
                        lineStyle: { normal: { color: "#f19544", width: 4 } },
                        markPoint: {
                            symbolOffset: [0, '-55%'],
                            label: {
                                normal: { fontSize: 20, color: "#000", formatter: '{c}' },
                            },
                            symbol: 'rect',
                            itemStyle: { normal: { color: "#f4a600" } },
                            symbolSize: [120, 50],
                            position: "inside",
                            data: [
                                { name: '最低值', value: 11.405, xAxis: 1, yAxis: 11.405 }
                            ]
                        }
                    }]
                };

                myChart3.setOption(option3);

                var myChart4 = ec.init(document.getElementById('main4'));
                var option4 = {
                    grid: {
                        borderWidth: '0',
                        x: '64',
                        y: '35',
                    },
                    xAxis: [{
                        type: 'category',
                        boundaryGap: false,
                        data: ['0', '1', '2'],
                        show: false,
                        axisLine: { lineStyle: { color: "#1d3f62", width: 3 } },
                    }],
                    yAxis: [

                        {
                            name: 'mm',
                            nameTextStyle: {
                                color: '#2579cf',
                                fontSize: 18,
                                align: 'left'
                            },
                            type: 'value',
                            splitLine: {
                                lineStyle: { color: "#1d3f62", type: 'dashed' }
                            },
                            max: 10,
                            splitNumber: 5,
                            axisLine: { lineStyle: { color: "#1d3f62", width: 3 } },
                            axisLabel: {
                                formatter: '{value}.00',
                                textStyle: {
                                    color: '#aaa',
                                    fontSize: 16
                                }
                            }
                        },
                        {
                            type: 'value',
                            axisLine: { lineStyle: { color: "#1d3f62", width: 3 } },
                        }
                    ],
                    series: [{
                        name: '高度值',
                        type: 'line',
                        symbolSize: 0,
                        data: [7.405, 7.405, 7.405],
                        lineStyle: { normal: { color: "#f19544", width: 4 } },
                        markPoint: {
                            symbolOffset: [0, '-55%'],
                            label: {
                                normal: { fontSize: 20, color: "#000", formatter: '{c}' },
                            },
                            symbol: 'rect',
                            itemStyle: { normal: { color: "#f4a600" } },
                            symbolSize: [120, 50],
                            position: "inside",
                            data: [
                                { name: '最低值', value: 11.405, xAxis: 1, yAxis: 11.405 }
                            ]
                        }
                    }]
                };

                myChart4.setOption(option4);

                var myChart5 = ec.init(document.getElementById('main5'));
                var option5 = {
                    grid: {
                        borderWidth: '0',
                        x: '64',
                        y: '35',
                    },
                    xAxis: [{
                        type: 'category',
                        boundaryGap: false,
                        data: ['0', '1', '2'],
                        show: false,
                        axisLine: { lineStyle: { color: "#1d3f62", width: 3 } },
                    }],
                    yAxis: [

                        {
                            name: 'mm',
                            nameTextStyle: {
                                color: '#2579cf',
                                fontSize: 18,
                                align: 'left'
                            },
                            type: 'value',
                            splitLine: {
                                lineStyle: { color: "#1d3f62", type: 'dashed' }
                            },
                            max: 10,
                            splitNumber: 5,
                            axisLine: { lineStyle: { color: "#1d3f62", width: 3 } },
                            axisLabel: {
                                formatter: '{value}.00',
                                textStyle: {
                                    color: '#aaa',
                                    fontSize: 16
                                }
                            }
                        },
                        {
                            type: 'value',
                            axisLine: { lineStyle: { color: "#1d3f62", width: 3 } },
                        }
                    ],
                    series: [{
                        name: '高度值',
                        type: 'line',
                        symbolSize: 0,
                        data: [7.405, 7.405, 7.405],
                        lineStyle: { normal: { color: "#f19544", width: 4 } },
                        markPoint: {
                            symbolOffset: [0, '-55%'],
                            label: {
                                normal: { fontSize: 20, color: "#000", formatter: '{c}' },
                            },
                            symbol: 'rect',
                            itemStyle: { normal: { color: "#f4a600" } },
                            symbolSize: [120, 50],
                            position: "inside",
                            data: [
                                { name: '最低值', value: 11.405, xAxis: 1, yAxis: 11.405 }
                            ]
                        }
                    }]
                };

                myChart5.setOption(option5);
                var getdata = GetData();
                clearInterval(timeTicket);
                var timeTicket = setInterval(GetData, 5000);

                function GetData() {
                    $.ajax({
                        type: "post",    //请求方式
                        async: true,     //是否异步
                        url: getUrl("GetCombustionChamberHightDetector"),
                        dataType: "json",    //跨域json请求一定是jsonp
                        beforeSend: function (request) {
                            //请求前的处理
                            request.setRequestHeader("Content-Type", "application/json");
                        },
                        success: function (data) {
                            //设备状态
                            setStatus(data.result.deviceStatus);

                            //公差
                            option.series[0].data[0].value = data.result.tolerance;
                            myChart.setOption(option, true);

                            //高度检1
                            var v1 = data.result.ranging1;
                            option2.series[0].data = new Array(v1, v1, v1);
                            option2.series[0].markPoint.data[0].value = v1;
                            option2.series[0].markPoint.data[0].yAxis = parseFloat(parseFloat(v1) + parseFloat("0.03"));
                            option2.yAxis[0].min = parseFloat(parseFloat(v1) - parseFloat("0.2"));
                            option2.yAxis[0].max = parseFloat(parseFloat(v1) + parseFloat("0.3"));
                            myChart2.setOption(option2, true);

                            //高度检2
                            var v2 = data.result.ranging2;
                            option3.series[0].data = new Array(v2, v2, v2);
                            option3.series[0].markPoint.data[0].value = v2;
                            option3.series[0].markPoint.data[0].yAxis = parseFloat(parseFloat(v2) + parseFloat("0.03"));
                            option3.yAxis[0].min = parseFloat(parseFloat(v2) - parseFloat("0.2"));
                            option3.yAxis[0].max = parseFloat(parseFloat(v2) + parseFloat("0.3"));
                            myChart3.setOption(option3, true);

                            //高度检3
                            var v3 = data.result.ranging3;
                            option4.series[0].data = new Array(v3, v3, v3);
                            option4.series[0].markPoint.data[0].value = v3;
                            option4.series[0].markPoint.data[0].yAxis = parseFloat(parseFloat(v3) + parseFloat("0.03"));
                            option4.yAxis[0].min = parseFloat(parseFloat(v3) - parseFloat("0.2"));
                            option4.yAxis[0].max = parseFloat(parseFloat(v3) + parseFloat("0.3"));
                            myChart4.setOption(option4, true);

                            //高度检4
                            var v4 = data.result.ranging4;
                            option5.series[0].data = new Array(v4, v4, v4);
                            option5.series[0].markPoint.data[0].value = v4;
                            option5.series[0].markPoint.data[0].yAxis = parseFloat(parseFloat(v4) + parseFloat("0.03"));
                            option5.yAxis[0].min = parseFloat(parseFloat(v4) - parseFloat("0.2"));
                            option5.yAxis[0].max = parseFloat(parseFloat(v4) + parseFloat("0.3"));
                            myChart5.setOption(option5, true);

                            //合格计数
                            document.getElementById("QualifiedCount").innerHTML = data.result.qualifiedCount + "<em>个</em>";
                            //不合格计数
                            document.getElementById("UnqualifiedCount").innerHTML = data.result.unqualifiedCount + "<em>个</em>";

                            //当前测试产品
                            document.getElementById("ProductName").innerText = data.result.productName;

                            //测试结果
                            document.getElementById("TestResult").innerText = data.result.testResult;

                            //循环时间
                            //document.getElementById("CycleTime").innerText = data.result.cycleTime;
                        },
                        error: function (msg) {
                            //console.log('api:GetCombustionChamberHightDetector,error:' + msg.responseText);
                        }
                    });


                    ////仪表1
                    //var min = option.series[0].min;
                    //var max = option.series[0].max;
                    //option.series[0].data[0].value = Math.floor(Math.random() * (max - min)) + min;
                    //myChart.setOption(option, true);

                    ////高度检1
                    //var v1 = (Math.random() * (7.7 - 7.3) + 7.3).toFixed(3);
                    //option2.series[0].data = new Array(v1, v1, v1);
                    //option2.series[0].markPoint.data[0].value = v1;
                    ////option.series[0].data[0].value = (Math.random() * 10).toFixed(3) - 0;
                    //myChart2.setOption(option2, true);

                    ////高度检2
                    //var v2 = (Math.random() * (7.7 - 7.3) + 7.3).toFixed(3);
                    //option3.series[0].data = new Array(v2, v2, v2);
                    //option3.series[0].markPoint.data[0].value = v2;
                    //myChart3.setOption(option3, true);

                    ////高度检3
                    //var v3 = (Math.random() * (7.7 - 7.3) + 7.3).toFixed(3);
                    //option4.series[0].data = new Array(v3, v3, v3);
                    //option4.series[0].markPoint.data[0].value = v3;
                    //myChart4.setOption(option4, true);

                    ////高度检4
                    //var v4 = (Math.random() * (7.7 - 7.3) + 7.3).toFixed(3);
                    //option5.series[0].data = new Array(v4, v4, v4);
                    //option5.series[0].markPoint.data[0].value = v4;
                    //myChart5.setOption(option5, true);
                }
            }
        );
    </script>
</body>
</html>